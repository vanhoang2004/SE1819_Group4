<!DOCTYPE html>
<html lang="en" xmlns:th="http://thymeleaf.org">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<title>Quick Quiz - Play</title>
		<link rel="stylesheet" href="app.css" />
		<link rel="stylesheet" href="game.css" />
		<style>
		:root {
	background-color: #ecf5ff;
	font-size: 62.5%;
}

* {
	box-sizing: border-box;
	font-family: Arial, Helvetica, sans-serif;
	margin: 0;
	padding: 0;
	color: #333;
}

h1,
h2,
h3,
h4 {
	margin-bottom: 1rem;
}

h1 {
	font-size: 5.4rem;
	color: #56a5eb;
	margin-bottom: 5rem;
}

h1 > span {
	font-size: 2.4rem;
	font-weight: 500;
}

h2 {
	font-size: 4.2rem;
	margin-bottom: 4rem;
	font-weight: 700;
}

h3 {
	font-size: 2.8rem;
	font-weight: 500;
}

/* UTILITIES */

.container {
	width: 100vw;
	height: 100vh;
	display: flex;
	justify-content: center;
	align-items: center;
	max-width: 80rem;
	margin: 0 auto;
	padding: 2rem;
}

.container > * {
	width: 100%;
}

.flex-column {
	display: flex;
	flex-direction: column;
}

.flex-center {
	justify-content: center;
	align-items: center;
}

.justify-center {
	justify-content: center;
}

.text-center {
	text-align: center;
}

.hidden {
	display: none;
}

/* BUTTONS */
.btn {
	font-size: 1.8rem;
	padding: 1rem 0;
	width: 20rem;
	text-align: center;
	border: 0.1rem solid #56a5eb;
	margin-bottom: 1rem;
	text-decoration: none;
	color: #56a5eb;
	background-color: white;
}

.btn:hover {
	cursor: pointer;
	box-shadow: 0 0.4rem 1.4rem 0 rgba(86, 185, 235, 0.5);
	transform: translateY(-0.1rem);
	transition: transform 150ms;
}

.btn[disabled]:hover {
	cursor: not-allowed;
	box-shadow: none;
	transform: none;
}
		
		</style>
		<style>
		.choice-container {
	display: flex;
	margin-bottom: 0.5rem;
	width: 100%;
	font-size: 1.8rem;
	border: 0.1rem solid rgb(86, 165, 235, 0.25);
	background-color: white;
}

.choice-container:hover {
	cursor: pointer;
	box-shadow: 0 0.4rem 1.4rem 0 rgba(86, 185, 235, 0.5);
	transform: translateY(-0.1rem);
	transition: transform 150ms;
}

.choice-prefix {
	padding: 1.5rem 2.5rem;
	background-color: #56a5eb;
	color: white;
}

.choice-text {
	padding: 1.5rem;
	width: 100%;
}

.correct {
	background-color: #28a745;
}

.incorrect {
	background-color: #dc3545;
}
		
		</style>
	</head>
	<body>
		<div class="container">
			<div id="game" class="justify-center flex-column">
				<h2 id="question">What is the answer to this questions?</h2>
				<div class="choice-container">
					<p class="choice-prefix">A</p>
					<p class="choice-text" data-number="1">Choice 1</p>
				</div>
				<div class="choice-container">
					<p class="choice-prefix">B</p>
					<p class="choice-text" data-number="2">Choice 2</p>
				</div>
				<div class="choice-container">
					<p class="choice-prefix">C</p>
					<p class="choice-text" data-number="3">Choice 3</p>
				</div>
				<div class="choice-container">
					<p class="choice-prefix">D</p>
					<p class="choice-text" data-number="4">Choice 4</p>
				</div>
			</div>
		</div>
		 <script th:inline="javascript">
        const questionElement = document.getElementById("question");
        const choices = Array.from(document.getElementsByClassName("choice-text"));

        let currentQuestion = {};
        let acceptingAnswers = false;
        let score = 0;
        let questionCounter = 0;
        let availableQuestions = [];
   
        // Populate questions from Thymeleaf variables
        /*<![CDATA[*/
        let questions = [
            /*[# th:each = "questioner : ${questionmocktest}"]*/
            {
                question: '[[${questioner.title}]]',
                choices: [
                    '[[${questioner.option1}]]',
                    '[[${questioner.option2}]]',
                    '[[${questioner.option3}]]',
                    '[[${questioner.option4}]]'
                ],
                answer: '[[${questioner.answer}]]'
            }
            /*[/]*/
        ];
        /*]]>*/

        // CONSTANTS
        const CORRECT_BONUS = 10;
        const MAX_QUESTIONS = 3;

        function startGame() {
            questionCounter = 0;
            score = 0;
            availableQuestions = [...questions];
            getNewQuestion();
        }

        function getNewQuestion() {
            if (availableQuestions.length === 0 || questionCounter >= MAX_QUESTIONS) {
                // Go to the end page
                return window.location.assign("/end.html");
            }
            questionCounter++;
            const questionIndex = Math.floor(Math.random() * availableQuestions.length);
            currentQuestion = availableQuestions[questionIndex];
            questionElement.innerText = currentQuestion.question;

            choices.forEach((choice, index) => {
                choice.innerText = currentQuestion.choices[index];
            });

            availableQuestions.splice(questionIndex, 1);
            acceptingAnswers = true;
        }

        choices.forEach((choice) => {
            choice.addEventListener("click", (e) => {
                if (!acceptingAnswers) return;

                acceptingAnswers = false;
                const selectedChoice = e.target;
                const selectedAnswer = selectedChoice.innerText;

                const classToApply = selectedAnswer === currentQuestion.answer ? "correct" : "incorrect";

                selectedChoice.parentElement.classList.add(classToApply);

                setTimeout(() => {
                    selectedChoice.parentElement.classList.remove(classToApply);
                    getNewQuestion();
                }, 1000);
            });
        });

        startGame();
    </script>
	</body>
</html>
